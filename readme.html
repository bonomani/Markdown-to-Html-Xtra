<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>readme</title>

  <!-- Style GitHub Flavored Markdown -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css" integrity="sha512-bHdFZhZyKzmx1cP6sV5rfhQ2YFJ9KzPqKBBhCuGWN5Shx4ghuQks5zhOaVpMfdhEMzVdINXjEon2mDqZcSHGJw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- Prism.js (core + theme + languages) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-markdown.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-yaml.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-powershell.min.js"></script>

  <!-- KaTeX core -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>

  <!-- Extensions -->
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/mhchem.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js"></script>

  <style>
    /* Style de base pour le corps de la page */
    body {
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
      line-height: 1.6;
      padding1: 1rem;
      max-width1: 1000px;
      margin1: auto;
      background-color: #ffffff;
      color: #24292e;
      max-width: 1012px;
      margin-right: auto;
      margin-left: auto;
      padding-right: 16px !important;
      padding-left: 16px !important;
    }
    .markdown-body {
      max-width: 980px;
      width: 100%;
      box-sizing: border-box;
      font-size: 16px;
      line-height: 1.5;
    }

    /* Titres */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.25;
    }

    /* Headings: mimic GitHub (sizes + underline for h1/h2) */
    .markdown-body h1 {
      font-size: 2em;
      padding-bottom: 0.3em;
      border-bottom: 1px solid #eaecef;
      margin: 0 0 16px;
    }

    .markdown-body h2 {
      font-size: 1.5em;
      padding-bottom: 0.3em;
      border-bottom: 1px solid #eaecef;
      margin: 24px 0 16px;
    }

    .markdown-body h3 {
      font-size: 1.25em;
      margin: 1em 0 0.5em;
    }

    .markdown-body h4 {
      font-size: 1.1em;
      margin: 1em 0 0.5em;
    }

    .markdown-body h5,
    .markdown-body h6 {
      font-size: 1em;
      margin: 1em 0 0.5em;
    }
   
    markdown-body .highlight pre, .markdown-body pre {
      padding: 16px;
      overflow: auto;
      font-size: 85%;
      line-height: 1.45;
      background-color: #f6f8fa;
      border-radius: 3px;
     } 
     
    .markdown-body table tr:nth-child(2n) {
      background-color: #f6f8fa;
    }
     
    button.copy-btn {
      position: absolute;
      top: 6px;
      right: 6px;
      font-size: 0.75em;
      padding: 0.2em 0.6em;
      background-color: #ccc;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }

    button.copy-btn:active {
      background-color: #bbb;
    }

    #download-button {
      position: absolute;
      top: 1rem;
      right: 1rem;
      padding: 0.4em 1em;
      font-size: 0.9em;
      cursor: pointer;
      background: #eee;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: system-ui, sans-serif;
    }
    

 
    /* Paragraphes */
    p {
      margin-top: 0;
      margin-bottom: 16px;
    }

    /* Liens */
    a {
      color: #0366d6;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    b,
    strong {
      font-weight:600
    }

    /* Listes */
    ul, ol {
      padding-left: 2em;
      margin-bottom: 0;
    }
        /* Listes */
    li {
      margin-top: 0.25em;
    }

    /* Blocs de code */
    /* position: relative; for  copy button */
    pre {
      position: relative; 
      background-color: #f6f8fa;
      padding: 1em;
      overflow: auto;
      border-radius: 6px;
    }
    code {
      background-color: #f6f8fa;
      padding: 0.2em 0.4em;
      border-radius: 6px;
      font-family: SFMono-Regular, Consolas, "Liberation Mono", Menlo, Courier, monospace;
      font-size: 85%;
    }

    /* Blocs de citation */
    blockquote {
      border-left: 0.25em solid #dfe2e5;
      padding: 0 1em;
      color: #6a737d;
      margin: 0;
    }

    /* Tableaux */
    table {
      border-collapse: collapse;
      border-spacing: 0;
    }
    th, td {
      border: 1px solid #dfe2e5;
      padding: 0.6em 1em;
    }
    th {
      background-color: #f6f8fa;
      font-weight: 600;
    }

    /* Lignes horizontales */
    hr {
      border: none;
      height: .25em;
      background-color: #e1e4e8;
      margin: 24px 0;
      overflow: hidden;
      
    }
 
  </style>
</head>
<body>

<article class="markdown-body">
<button id="download-button" class="download-btn" onclick="downloadCurrentPage()">ğŸ’¾ Download</button>
<h1 id="pencil-markdown-to-html-xtra">ğŸ“ Markdown-to-Html-Xtra</h1>
<p><strong>A PowerShell script to convert Markdown into enriched,
standalone HTML.</strong> Generate clean, styled HTML documents from
<code>.md</code> files â€” complete with KaTeX, Mermaid, syntax
highlighting, and copyable code blocks.</p>
<hr />
<h2 id="books-table-of-contents">ğŸ“š Table of Contents</h2>
<ul>
<li><a
href="https://bonomani.github.io/Markdown-to-Html-Xtra/readme.html">ğŸŒ
View Demo Output</a></li>
<li><a href="#sparkles-key-features">âœ¨ Key Features</a></li>
<li><a href="#rocket-usage">ğŸš€ Usage</a></li>
<li><a href="#gear-requirements">âš™ï¸ Requirements</a></li>
<li><a href="#writing_hand-markdown">ğŸ“„ Markdown</a>
<ul>
<li><a href="#pushpin-unordered-list">ğŸ“Œ Unordered List</a></li>
<li><a href="#1234-ordered-list">ğŸ”¢ Ordered List</a></li>
<li><a href="#link-links-and-images">ğŸ”— Links and Images</a></li>
<li><a href="#pencil-blockquote">ğŸ“ Blockquote</a></li>
<li><a href="#white_check_mark-task-list">âœ… Task List</a></li>
<li><a href="#test_tube-table">ğŸ§ª Table</a></li>
<li><a href="#speech_balloon-inline-code">ğŸ’¬ Inline Code</a></li>
</ul></li>
<li><a href="#clipboard-katex">ğŸ“Š KaTeX</a>
<ul>
<li><a href="#triangular_ruler-katex-math">ğŸ“ Math</a></li>
<li><a href="#test_tube-katex-chemistry">ğŸ§ª Chemistry</a></li>
</ul></li>
<li><a href="#brain-mermaid-diagram">ğŸ§  Mermaid Diagram</a></li>
<li><a href="#-syntax-highlighting">ğŸ– Syntax Highlighting</a></li>
<li><a href="#page_facing_up-source-readmemd">ğŸ“„ Source: readme.md</a></li>
</ul>
<hr />
<h2 id="sparkles-key-features">âœ¨ Key Features</h2>
<ul>
<li>ğŸ—’ï¸ Converts <strong>Markdown</strong> to clean, semantic
<strong>HTML5</strong> via <strong>Pandoc</strong></li>
<li>ğŸ“ Renders <strong>KaTeX</strong> math (inline &amp; block)</li>
<li>ğŸ§  Supports <strong>Mermaid</strong> diagrams (flowcharts, Gantt,
etc.)</li>
<li>ğŸ” Handles <strong>nested code fences</strong> and <strong>GitHub
Flavored Markdown (GFM)</strong></li>
<li>ğŸ“‹ Adds <strong>copy-to-clipboard</strong> buttons to code
blocks</li>
<li>ğŸ– Enables <strong>syntax highlighting</strong> via
<strong>Prism.js</strong></li>
<li>ğŸ’¾ Generates a lightweight <strong>standalone HTML</strong>
(internet required)</li>
<li>ğŸ“¥ Optional <strong>download button</strong> when viewed online</li>
</ul>
<hr />
<h2 id="rocket-usage">ğŸš€ Usage</h2>
<pre><code class='language-powershell'>.\markdown_to_htmlx.ps1 -InputFile readme.md</code></pre>

<h3 id="options">Options</h3>
<ul>
<li><code>-InputFile</code> â€” Path to the <code>.md</code> file
(<strong>required</strong>)</li>
<li><code>-OutputFile</code> â€” Output <code>.html</code> file name
(default: input name + <code>.html</code>)</li>
<li><code>-TemplateFile</code> â€” Custom HTML template (default:
<code>simple_standalone_tmpl.html</code>)</li>
</ul>
<hr />
<h2 id="gear-requirements">âš™ï¸ Requirements</h2>
<ul>
<li>PowerShell (Windows, macOS, or Linux)</li>
<li><a href="https://pandoc.org/installing.html">Pandoc</a> â€” must be
installed and in your system <code>PATH</code></li>
</ul>
<hr />
<h2 id="page_facing_up-markdown">ğŸ“„ Markdown</h2>
<h3 id="pushpin-unordered-list">ğŸ“Œ Unordered List</h3>
<ul>
<li>Item 1</li>
<li>Item 2
<ul>
<li>Subitem 2.1</li>
<li>Subitem 2.2</li>
</ul></li>
</ul>
<hr />
<h3 id="1234-ordered-list">ğŸ”¢ Ordered List</h3>
<ol type="1">
<li>First</li>
<li>Second
<ol type="1">
<li>Substep A</li>
<li>Substep B</li>
</ol></li>
</ol>
<hr />
<h3 id="link-links-and-images">ğŸ”— Links and Images</h3>
<p>Here is a <a href="https://openai.com">link to OpenAI</a>.</p>
<p><img src="https://openai.com/favicon.ico" alt="OpenAI Logo" /></p>
<hr />
<h3 id="pencil-blockquote">ğŸ“ Blockquote</h3>
<blockquote>
<p>â€œMarkdown is easy to read and write.â€<br />
â€” <em>Some Developer</em></p>
</blockquote>
<hr />
<h3 id="white_check_mark-task-list">âœ… Task List</h3>
<ul class="task-list">
<li><label><input type="checkbox" checked="" />Understand
Markdown</label></li>
<li><label><input type="checkbox" />Render KaTeX</label></li>
</ul>
<ul>
<li>âœ… Use Mermaid</li>
<li>â¬œï¸ Profit</li>
</ul>
<hr />
<h3 id="test_tube-table">ğŸ§ª Table</h3>
<table>
<thead>
<tr>
<th>Syntax</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Header</td>
<td>Title</td>
</tr>
<tr>
<td>Cell</td>
<td>Text</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="speech_balloon-inline-code">ğŸ’¬ Inline Code</h3>
<p>Use `print()` in Python to output text:</p>
<p>Example: <code>print("Hello, world!")</code></p>
<hr />
<h2 id="clipboard-katex">ğŸ“‹ KaTeX</h2>
<p><em>(Copy-TeX extension)</em></p>
<p>You can copy rendered math formulas as LaTeX source.<br />
This is useful for reuse in LaTeX editors, documents, and Markdown
files<br />
that support KaTeX or MathJax.</p>
<hr />
<h3 id="triangular_ruler-katex-math">ğŸ“ KaTeX Math</h3>
<p>Inline math: $\dv{f}{x} = 3x^2$.</p>
<p>Block math:</p>
<p><span class="math display">$$
\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}
$$</span></p>
<hr />
<h3 id="test_tube-katex-chemistry">ğŸ§ª KaTeX Chemistry</h3>
<p>Chemical reaction: $\ce{CO2 + C -&gt; 2CO}$</p>
<p>Equilibrium: $\ce{N2 + 3H2 &lt;=&gt; 2NH3}$</p>
<p>Isotope: $\ce{^{227}_{90}Th+}$</p>
<hr />
<h2 id="brain-mermaid-diagram">ğŸ§  Mermaid Diagram</h2>
<div class='mermaid'>graph TD
  A[Start] --> B{Is it working?}
  B -- Yes --> C[Great!]
  B -- No --> D[Fix it]
  D --> B</div>

<hr />
<h2 id="-syntax-highlighting">ğŸ– Syntax Highlighting</h2>
<h3 id="wrench-bash">ğŸ”§ Bash</h3>
<pre><code class='language-bash'>#!/bin/bash
echo "Hello, world!"
if [ "$1" == "test" ]; then
  echo "Testing mode"
fi</code></pre>

<h3 id="-json">ğŸ—‚ JSON</h3>
<pre><code class='language-json'>{
  "name": "example",
  "version": "1.0.0",
  "dependencies": {
    "prismjs": "^1.29.0"
  }
}</code></pre>

<h3 id="snake-python">ğŸ Python</h3>
<pre><code class='language-python'>def factorial(n):
    return 1 if n == 0 else n * factorial(n - 1)

print(factorial(5))</code></pre>

<h3 id="scroll-javascript">ğŸ“œ JavaScript</h3>
<pre><code class='language-javascript'>function greet(name) {
  console.log(`Hello, ${name}!`);
}

greet("Markdown");</code></pre>

<h3 id="writing_hand-markdown">âœï¸ Markdown</h3>
<pre><code class='language-markdown'># Hello Markdown

- List item 1
- List item 2

**Bold text** and *italic text*

```python
print("This is a nested code block.")
```
</code></pre>

<h3 id="receipt-yaml">ğŸ§¾ YAML</h3>
<pre><code class='language-yaml'>version: "3"
services:
  web:
    image: nginx:latest
    ports:
      - "80:80"</code></pre>

<h3 id="zap-powershell">âš¡ PowerShell</h3>
<pre><code class='language-powershell'>param (
  [string]$Name = "World"
)

Write-Host "Hello, $Name!"</code></pre>

<hr />
<h3 id="page_facing_up-source-readmemd">ğŸ“„ Source: readme.md</h3>
<pre><code class='language-markdown'># ğŸ“ Markdown-to-Html-Xtra

**A PowerShell script to convert Markdown into enriched, standalone HTML.**
Generate clean, styled HTML documents from `.md` files â€” complete with KaTeX, Mermaid, syntax highlighting, and copyable code blocks.

---

## ğŸ“š Table of Contents

* [ğŸŒ View Demo Output](https://bonomani.github.io/Markdown-to-Html-Xtra/readme.html)
* [âœ¨ Key Features](#-key-features)
* [ğŸš€ Usage](#-usage)
* [âš™ï¸ Requirements](#-requirements)
* [ğŸ“„ Markdown](#-markdown)
  * [ğŸ“Œ Unordered List](#-unordered-list)
  * [ğŸ”¢ Ordered List](#-ordered-list)
  * [ğŸ”— Links and Images](#-links-and-images)
  * [ğŸ“ Blockquote](#-blockquote)
  * [âœ… Task List](#-task-list)
  * [ğŸ§ª Table](#-table)
  * [ğŸ’¬ Inline Code](#-inline-code)
* [ğŸ“Š KaTeX](#-katex)
  * [ğŸ“ Math](#-katex-math)
  * [ğŸ§ª Chemistry](#-katex-chemistry)
* [ğŸ§  Mermaid Diagram](#-mermaid-diagram)
* [ğŸ– Syntax Highlighting](#-syntax-highlighting)
* [ğŸ“„ Source: readme.md](#-source-readmemd)


---

## âœ¨ Key Features

* ğŸ—’ï¸ Converts **Markdown** to clean, semantic **HTML5** via **Pandoc**
* ğŸ“ Renders **KaTeX** math (inline & block)
* ğŸ§  Supports **Mermaid** diagrams (flowcharts, Gantt, etc.)
* ğŸ” Handles **nested code fences** and **GitHub Flavored Markdown (GFM)**
* ğŸ“‹ Adds **copy-to-clipboard** buttons to code blocks
* ğŸ– Enables **syntax highlighting** via **Prism.js**
* ğŸ’¾ Generates a lightweight **standalone HTML** (internet required)
* ğŸ“¥ Optional **download button** when viewed online

---

## ğŸš€ Usage

```powershell
.\markdown_to_htmlx.ps1 -InputFile readme.md
```

### Options

* `-InputFile` â€” Path to the `.md` file (**required**)
* `-OutputFile` â€” Output `.html` file name (default: input name + `.html`)
* `-TemplateFile` â€” Custom HTML template (default: `simple_standalone_tmpl.html`)

---

## âš™ï¸ Requirements

* PowerShell (Windows, macOS, or Linux)
* [Pandoc](https://pandoc.org/installing.html) â€” must be installed and in your system `PATH`


---


## ğŸ“„ Markdown

### ğŸ“Œ Unordered List

- Item 1  
- Item 2  
  - Subitem 2.1  
  - Subitem 2.2  

---

### ğŸ”¢ Ordered List

1. First  
2. Second  
   1. Substep A  
   2. Substep B  

---

### ğŸ”— Links and Images

Here is a [link to OpenAI](https://openai.com).  

![OpenAI Logo](https://openai.com/favicon.ico)

---

### ğŸ“ Blockquote

> â€œMarkdown is easy to read and write.â€  
> â€” *Some Developer*

---

### âœ… Task List

- [x] Understand Markdown  
- [ ] Render KaTeX  
- âœ… Use Mermaid  
- â¬œï¸ Profit  

---

### ğŸ§ª Table

| Syntax  | Description |
|---------|-------------|
| Header  | Title       |
| Cell    | Text        |

---

### ğŸ’¬ Inline Code

Use \`print()\` in Python to output text:

Example: `print("Hello, world!")`

---

## ğŸ“‹ KaTeX

*(Copy-TeX extension)*

You can copy rendered math formulas as LaTeX source.  
This is useful for reuse in LaTeX editors, documents, and Markdown files  
that support KaTeX or MathJax.

---

### ğŸ“ KaTeX Math

Inline math: $\dv{f}{x} = 3x^2$.

Block math:

$$
\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}
$$

---

### ğŸ§ª KaTeX Chemistry

Chemical reaction: $\ce{CO2 + C -> 2CO}$

Equilibrium: $\ce{N2 + 3H2 <=> 2NH3}$

Isotope: $\ce{^{227}_{90}Th+}$

---

## ğŸ§  Mermaid Diagram

```mermaid
graph TD
  A[Start] --> B{Is it working?}
  B -- Yes --> C[Great!]
  B -- No --> D[Fix it]
  D --> B
```

---

## ğŸ– Syntax Highlighting

### ğŸ”§ Bash

```bash
#!/bin/bash
echo "Hello, world!"
if [ "$1" == "test" ]; then
  echo "Testing mode"
fi
```

### ğŸ—‚ JSON

```json
{
  "name": "example",
  "version": "1.0.0",
  "dependencies": {
    "prismjs": "^1.29.0"
  }
}
```

### ğŸ Python

```python
def factorial(n):
    return 1 if n == 0 else n * factorial(n - 1)

print(factorial(5))
```

### ğŸ“œ JavaScript

```javascript
function greet(name) {
  console.log(`Hello, ${name}!`);
}

greet("Markdown");
```

### âœï¸ Markdown

````markdown
# Hello Markdown

- List item 1
- List item 2

**Bold text** and *italic text*

```python
print("This is a nested code block.")
```

````

### ğŸ§¾ YAML

```yaml
version: "3"
services:
  web:
    image: nginx:latest
    ports:
      - "80:80"
```

### âš¡ PowerShell

```powershell
param (
  [string]$Name = "World"
)

Write-Host "Hello, $Name!"
```
</code></pre>

</article>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js" type="module"></script>
<script>
document.addEventListener("DOMContentLoaded", () => {

  // Copy buttons for <pre>
  document.querySelectorAll('pre').forEach(pre => {
    const btn = document.createElement('button');
    btn.className = 'copy-btn';
    btn.setAttribute('aria-label', 'Copy code');
    btn.textContent = 'Copy';

    btn.onclick = () => {
      const code = [...pre.childNodes]
        .filter(n => n.nodeName !== 'BUTTON')
        .map(n => n.innerText || n.textContent)
        .join('');
      navigator.clipboard.writeText(code).then(() => {
        btn.textContent = 'Copied!';
        setTimeout(() => btn.textContent = 'Copy', 1500);
      });
    };

    pre.appendChild(btn);
  });

  // Math rendering (KaTeX)
  if (typeof renderMathInElement === "function") {
    renderMathInElement(document.body, {
      delimiters: [
          { left: "$$", right: "$$", display: true },
          { left: "$",  right: "$",  display: false }
        ],
        trust: true,
        throwOnError: false,
        macros: {
          "\\dd": "\\,\\mathrm{d}",
          "\\dv": "\\dfrac{\\mathrm{d}#1}{\\mathrm{d}#2}",
          "\\dvN": "\\dfrac{\\mathrm{d}^{#1}#2}{\\mathrm{d}#3^{#1}}",
          "\\pdv": "\\dfrac{\\partial #1}{\\partial #2}",
          "\\pdvN": "\\dfrac{\\partial^{#1}#2}{\\partial #3^{#1}}",
          "\\pderivative": "\\dfrac{\\partial #1}{\\partial #2}",
          "\\derivative": "\\dfrac{\\mathrm{d}#1}{\\mathrm{d}#2}",
          "\\qty": "\\left#1#2\\right#1",
          "\\abs": "\\left|#1\\right|",
          "\\norm": "\\left\\lVert#1\\right\\rVert",
          "\\eval": "\\left. #1 \\right\\rvert_{#2}",
          "\\ang": "\\langle #1 \\rangle",
          "\\order": "\\mathcal{O}\\left(#1\\right)",
          "\\comm": "\\left[ #1 , #2 \\right]",
          "\\acomm": "\\left\\{ #1 , #2 \\right\\}",
          "\\braket": "\\left\\langle #1 \\middle| #2 \\right\\rangle",
          "\\mel": "\\left\\langle #1 \\middle| #2 \\middle| #3 \\right\\rangle",
          "\\expectation": "\\left\\langle #1 \\right\\rangle",
          "\\op": "\\hat{#1}"
        }
    });
  }

  // Mermaid init (if script loaded properly)
  if (window.mermaid?.initialize) {
    mermaid.initialize({ startOnLoad: true });
  }

  // Show download button if served via HTTP
  const btn = document.getElementById("download-button");
  if (window.location.protocol.startsWith("http")) {
    btn.style.display = "inline-block";
  } else {
    btn.remove();
  }

});
</script>

<script>
function downloadCurrentPage() {
  const html = '<!DOCTYPE html>' + document.documentElement.outerHTML;
  const blob = new Blob([html], { type: "text/html;charset=utf-8" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = (document.title?.trim() || "document") + ".html";
  document.body.appendChild(a);  // ensure it's in DOM for Firefox
  a.click();
  document.body.removeChild(a);  // cleanup

  setTimeout(() => URL.revokeObjectURL(url), 100);
}
</script>

</body>

</html>
